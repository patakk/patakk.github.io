const PERLIN_YWRAPB=4,PERLIN_YWRAP=16,PERLIN_ZWRAPB=8,PERLIN_ZWRAP=256,PERLIN_SIZE=4095;let perlin_octaves=4,perlin_amp_falloff=.5;const scaled_cosine=e=>.5*(1-Math.cos(e*Math.PI));let perlin;noise=function(e,n=0,l=0){if(null==perlin){perlin=new Array(4096);for(let e=0;e<4096;e++)perlin[e]=fxrand()}e<0&&(e=-e),n<0&&(n=-n),l<0&&(l=-l);let r,i,o,t,a,p=Math.floor(e),f=Math.floor(n),s=Math.floor(l),c=e-p,_=n-f,d=l-s,P=0,R=.5;for(let e=0;e<perlin_octaves;e++){let e=p+(f<<4)+(s<<8);r=scaled_cosine(c),i=scaled_cosine(_),o=perlin[4095&e],o+=r*(perlin[e+1&4095]-o),t=perlin[e+16&4095],o+=i*((t+=r*(perlin[e+16+1&4095]-t))-o),t=perlin[4095&(e+=256)],t+=r*(perlin[e+1&4095]-t),a=perlin[e+16&4095],t+=i*((a+=r*(perlin[e+16+1&4095]-a))-t),P+=(o+=scaled_cosine(d)*(t-o))*R,R*=perlin_amp_falloff,p<<=1,f<<=1,s<<=1,(c*=2)>=1&&(p++,c--),(_*=2)>=1&&(f++,_--),(d*=2)>=1&&(s++,d--)}return P},noiseDetail=function(e,n){e>0&&(perlin_octaves=e),n>0&&(perlin_amp_falloff=n)},noiseSeed=function(e){const n=(()=>{const e=4294967296;let n,l;return{setSeed(r){l=n=(null==r?fxrand()*e:r)>>>0},getSeed:()=>n,rand:()=>(l=(1664525*l+1013904223)%e)/e}})();n.setSeed(e),perlin=new Array(4096);for(let e=0;e<4096;e++)perlin[e]=n.rand()};